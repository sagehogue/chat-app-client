{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Willp\\\\Desktop\\\\chat-app-sage\\\\chat-app-client-master\\\\src\\\\App.js\";\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport * as firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport io from \"socket.io-client\";\nimport { BrowserRouter as Router, Route, Redirect } from \"react-router-dom\";\nimport firebaseConfig from \"./firebaseConfig\";\nimport Loader from \"./components/UI/Animations/Loading/Loading\";\nimport Chat from \"./components/Chat/Chat\";\nimport Join from \"./components/Join/Join\";\nimport LoginPage from \"./pages/LoginPage/LoginPage\";\nimport HomePage from \"./pages/HomePage/HomePage\";\nimport GlobalStyle from \"./util/GlobalStyles/GlobalStyles\"; // TODOS:\n// Refactor redundant/useless code. Looks like there's lots of repetition here.\n// Make a background component, use it on loginpage/homepage/loader to keep it from flashing white on load\n// Initialize firebase for auth purposes\n\nfirebase.initializeApp(firebaseConfig); // initialize socket.io\n\nlet socket;\nconst ENDPOINT = \"localhost:5000\";\nconst SocketContext = React.createContext(socket);\nconst SocketProvider = SocketContext.Provider;\nexport const SocketConsumer = SocketContext.Consumer;\nsocket = io(ENDPOINT, {\n  query: \"displayName=``\"\n}); // Listen for auth events\n\nfunction onAuthStateChange(callback) {\n  return firebase.auth().onAuthStateChanged(user => {\n    if (user) {\n      console.log(\"Socket.io connecting displayName \" + user.displayName);\n      socket.query = {\n        displayName: user.displayName\n      }; // socket = io(ENDPOINT, { query: `displayName=${user.displayName}` });\n\n      callback({\n        loggedIn: true,\n        displayName: user.displayName,\n        email: user.email,\n        emailVerified: user.emailVerified,\n        photoURL: user.photoURL,\n        isAnonymous: user.isAnonymous,\n        uid: user.uid\n      });\n    } else {\n      callback({\n        loggedIn: false\n      });\n    }\n  });\n}\n\nfunction login(username, password) {\n  firebase.auth().signInWithEmailAndPassword(username, password);\n}\n\nfunction logout() {\n  firebase.auth().signOut();\n}\n\nexport const getStorageRef = () => {\n  const storage = firebase.storage();\n  return storage.ref();\n};\nexport const firebaseController = {\n  login: (email, password) => login(email, password),\n  logout: logout\n}; // Initial/default context state\n\nconst defaultUser = {\n  loggedIn: false\n}; // object which must be imported to access context\n\nexport const AuthContext = React.createContext(defaultUser);\nconst UserProvider = AuthContext.Provider;\nexport const UserConsumer = AuthContext.Consumer; // END OF FUNCTION DEFINITIONS\n\nconst App = () => {\n  const requestLogin = useCallback((username, password) => {\n    login(username, password);\n  });\n  const requestLogout = useCallback(() => {\n    logout();\n  }, []);\n  useEffect(() => {\n    const unsubscribe = onAuthStateChange(setUser);\n    return () => {\n      unsubscribe();\n    };\n  }, []);\n  const [user, setUser] = useState({\n    loggedIn: null\n  }); //  Maybe check if null, false, or true and display loading, loggedout, loggedin.\n  // const [user, setUser] = useState({ loggedIn: firebase.auth().currentUser });\n  // <ThemeContext.Consumer>\n  //   {\n  //     theme => (<UserContext.Consumer>\n  //       {\n  //         user => (<ProfilePage user={user} theme={theme} />)\n  //       }\n  //     </UserContext.Consumer>)\n  //   }\n  // </ThemeContext.Consumer>\n\n  return /*#__PURE__*/React.createElement(Router, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(SocketProvider, {\n    value: socket,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(UserProvider, {\n    value: user,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Route, {\n    path: \"/\",\n    exact: true,\n    render: props => user.loggedIn == null ? /*#__PURE__*/React.createElement(Loader, {\n      fullscreen: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }\n    }) : user.loggedIn ? /*#__PURE__*/React.createElement(SocketConsumer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }\n    }, socket => /*#__PURE__*/React.createElement(HomePage, Object.assign({\n      socket: socket\n    }, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 32\n      }\n    }))) : /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/login\",\n    render: props => user.loggedIn == /*#__PURE__*/React.createElement(Loader, {\n      fullscreen: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 32\n      }\n    }) ? null : user.loggedIn ? /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 17\n      }\n    }) : /*#__PURE__*/React.createElement(SocketConsumer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 17\n      }\n    }, socket => /*#__PURE__*/React.createElement(LoginPage, Object.assign({\n      socket: socket\n    }, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 32\n      }\n    }))),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(GlobalStyle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 11\n    }\n  }))));\n};\n\nexport default App;","map":{"version":3,"sources":["C:/Users/Willp/Desktop/chat-app-sage/chat-app-client-master/src/App.js"],"names":["React","useState","useEffect","useCallback","firebase","io","BrowserRouter","Router","Route","Redirect","firebaseConfig","Loader","Chat","Join","LoginPage","HomePage","GlobalStyle","initializeApp","socket","ENDPOINT","SocketContext","createContext","SocketProvider","Provider","SocketConsumer","Consumer","query","onAuthStateChange","callback","auth","onAuthStateChanged","user","console","log","displayName","loggedIn","email","emailVerified","photoURL","isAnonymous","uid","login","username","password","signInWithEmailAndPassword","logout","signOut","getStorageRef","storage","ref","firebaseController","defaultUser","AuthContext","UserProvider","UserConsumer","App","requestLogin","requestLogout","unsubscribe","setUser","props"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\r\nimport * as firebase from \"firebase/app\";\r\nimport \"firebase/auth\";\r\nimport io from \"socket.io-client\";\r\nimport { BrowserRouter as Router, Route, Redirect } from \"react-router-dom\";\r\nimport firebaseConfig from \"./firebaseConfig\";\r\n\r\nimport Loader from \"./components/UI/Animations/Loading/Loading\";\r\n\r\nimport Chat from \"./components/Chat/Chat\";\r\nimport Join from \"./components/Join/Join\";\r\nimport LoginPage from \"./pages/LoginPage/LoginPage\";\r\nimport HomePage from \"./pages/HomePage/HomePage\";\r\nimport GlobalStyle from \"./util/GlobalStyles/GlobalStyles\";\r\n\r\n// TODOS:\r\n// Refactor redundant/useless code. Looks like there's lots of repetition here.\r\n// Make a background component, use it on loginpage/homepage/loader to keep it from flashing white on load\r\n\r\n// Initialize firebase for auth purposes\r\nfirebase.initializeApp(firebaseConfig);\r\n\r\n// initialize socket.io\r\nlet socket;\r\nconst ENDPOINT = \"localhost:5000\";\r\nconst SocketContext = React.createContext(socket);\r\nconst SocketProvider = SocketContext.Provider;\r\nexport const SocketConsumer = SocketContext.Consumer;\r\nsocket = io(ENDPOINT, { query: \"displayName=``\" });\r\n// Listen for auth events\r\nfunction onAuthStateChange(callback) {\r\n  return firebase.auth().onAuthStateChanged((user) => {\r\n    if (user) {\r\n      console.log(\"Socket.io connecting displayName \" + user.displayName);\r\n      socket.query = { displayName: user.displayName };\r\n      // socket = io(ENDPOINT, { query: `displayName=${user.displayName}` });\r\n      callback({\r\n        loggedIn: true,\r\n        displayName: user.displayName,\r\n        email: user.email,\r\n        emailVerified: user.emailVerified,\r\n        photoURL: user.photoURL,\r\n        isAnonymous: user.isAnonymous,\r\n        uid: user.uid,\r\n      });\r\n    } else {\r\n      callback({ loggedIn: false });\r\n    }\r\n  });\r\n}\r\n\r\nfunction login(username, password) {\r\n  firebase.auth().signInWithEmailAndPassword(username, password);\r\n}\r\nfunction logout() {\r\n  firebase.auth().signOut();\r\n}\r\n\r\nexport const getStorageRef = () => {\r\n  const storage = firebase.storage();\r\n  return storage.ref();\r\n};\r\n\r\nexport const firebaseController = {\r\n  login: (email, password) => login(email, password),\r\n  logout: logout,\r\n};\r\n// Initial/default context state\r\nconst defaultUser = { loggedIn: false };\r\n// object which must be imported to access context\r\nexport const AuthContext = React.createContext(defaultUser);\r\n\r\nconst UserProvider = AuthContext.Provider;\r\nexport const UserConsumer = AuthContext.Consumer;\r\n\r\n// END OF FUNCTION DEFINITIONS\r\n\r\nconst App = () => {\r\n  const requestLogin = useCallback((username, password) => {\r\n    login(username, password);\r\n  });\r\n  const requestLogout = useCallback(() => {\r\n    logout();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = onAuthStateChange(setUser);\r\n    return () => {\r\n      unsubscribe();\r\n    };\r\n  }, []);\r\n  const [user, setUser] = useState({ loggedIn: null });\r\n\r\n  //  Maybe check if null, false, or true and display loading, loggedout, loggedin.\r\n\r\n  // const [user, setUser] = useState({ loggedIn: firebase.auth().currentUser });\r\n\r\n  // <ThemeContext.Consumer>\r\n  //   {\r\n  //     theme => (<UserContext.Consumer>\r\n  //       {\r\n  //         user => (<ProfilePage user={user} theme={theme} />)\r\n  //       }\r\n  //     </UserContext.Consumer>)\r\n  //   }\r\n  // </ThemeContext.Consumer>\r\n  return (\r\n    <Router>\r\n      <SocketProvider value={socket}>\r\n        <UserProvider value={user}>\r\n          {/* Put loading component here */}\r\n          <Route\r\n            path=\"/\"\r\n            exact\r\n            render={(props) =>\r\n              user.loggedIn == null ? (\r\n                <Loader fullscreen />\r\n              ) : user.loggedIn ? (\r\n                <SocketConsumer>\r\n                  {(socket) => <HomePage socket={socket} {...props} />}\r\n                </SocketConsumer>\r\n              ) : (\r\n                <Redirect to=\"/login\" />\r\n              )\r\n            }\r\n          />\r\n          <Route\r\n            path=\"/login\"\r\n            render={(props) =>\r\n              user.loggedIn == <Loader fullscreen /> ? null : user.loggedIn ? (\r\n                <Redirect to=\"/\" />\r\n              ) : (\r\n                <SocketConsumer>\r\n                  {(socket) => <LoginPage socket={socket} {...props} />}\r\n                </SocketConsumer>\r\n              )\r\n            }\r\n          />\r\n          <GlobalStyle />\r\n        </UserProvider>\r\n      </SocketProvider>\r\n    </Router>\r\n  );\r\n};\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}