{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Willp\\\\Desktop\\\\chat-app-sage\\\\chat-app-client-master\\\\src\\\\pages\\\\HomePage\\\\HomePage.js\";\nimport React, { useState, useEffect, useLayoutEffect, useContext } from \"react\";\nimport { FaUserFriends, FaRegComments, FaHome } from \"react-icons/fa\";\nimport styled from \"styled-components\";\nimport * as firebase from \"firebase/app\"; // Add the Firebase services that you want to use\n\nimport \"firebase/auth\";\nimport \"firebase/firestore\";\nimport firebaseConfig from \"../../firebaseConfig\";\nimport { firebaseController } from \"../../App\";\nimport FriendsTab from \"./FriendsTab/FriendsTab\";\nimport RoomsTab from \"./RoomsTab/RoomsTab\";\nimport Chat from \"../../components/Chat/Chat\";\nimport Join from \"../../components/Join/Join\";\nimport Backdrop from \"../../components/UI/Backdrop/Backdrop\";\nimport CreateRoomModal from \"./NewRoomModal/NewRoomModal\";\nimport { AuthContext } from \"../../App\";\nimport { BackdropContextProvier } from \"../../components/UI/Backdrop/Backdrop\";\nimport Theme from \"../../util/Theme/Theme\";\nimport GlobalStyle from \"../../util/GlobalStyles/GlobalStyles\"; //      **********TODOS***********\n//\n// Create roomDisconnect event to fire when user clicks X on chat window, thus leaving the chat.\n//          *****STYLING*****\n// Fix following issue: When page is loaded directly from url bar and not from login page, it redirects to login even if immediately authenticated.\n// adjust proportions of menus - they take up too much space.\n// Create chat bubbles, user text backgrounds for better message differentiation\n// Chat app looks a little stretched out on desktop, adjust for better\n// center focus\n\n/* Description of implementation of this component:\r\n\r\n3 states\r\n1.) display no side bars, only main conversation\r\n2.) show left sidebar\r\n3.) show right sidebar\r\n\r\nWe should seek to adjust the whitespace around the main component so it never shifts the content. I'm thinking a system like this will work:\r\n<main>\r\n  <leftsidebar />\r\n    <content-wrapper>\r\n      <chat />\r\n    </content-wrapper>\r\n  <rightsidebar />\r\n</main>\r\n\r\nthe main will be a grid. the main will have state that controls the display, and the grid css will correspond to the state to render the screen how we want.\r\ni.e. in state 1 content-wrapper will span the whole grid, in state 2 it'll span the right 3/4 of the screen, in state 3 it'll span the left 3/4 of the screen.\r\n*/\n\nconst HomePageGrid = styled.main`\n  display: grid;\n  grid-template-columns: 1fr 3fr 1fr;\n  grid-template-rows: repeat(10, 1fr);\n  height: 100vh;\n  max-width: 100vw;\n  overflow: hidden;\n  background: #016789;\n`;\nconst Navigation = styled.nav`\n  font-size: 2rem;\n  display: flex;\n  height: 10vh;\n  justify-content: space-between;\n  grid-row: ${Theme.layout.gridRowNav};\n  width: 100%;\n  grid-column: ${Theme.layout.gridColNav};\n  z-index: 1;\n  padding-top: 1rem;\n  color: rgba(255, 255, 255, 0.9);\n  & svg {\n    transition: all ${Theme.navTransitionDuration};\n  }\n  & svg:first-child {\n    margin-left: 1rem;\n    color: ${props => props.pageOnDisplay == \"friends\" ? `${Theme.navColorActive}` : `${Theme.navColorInactive}`};\n  }\n  & svg:last-child {\n    margin-right: 1rem;\n    color: ${props => props.pageOnDisplay == \"rooms\" ? `${Theme.navColorActive}` : `${Theme.navColorInactive}`};\n  }\n      @media screen and (min-width: 1200px) {\n        font-size: 2.25rem;\n        & svg:first-child {\n          margin-left: 3rem;\n        }\n        & svg:last-child {\n          margin-right: 3rem;\n        }\n        }\n        @media screen and (min-width: 1600px) {\n          font-size: 2.5rem;\n          & svg:first-child {\n            margin-left: 4.5rem;\n          }\n          & svg:last-child {\n            margin-right: 4.5rem;\n          }\n          }\n          }\n`;\nexport default function HomePage({\n  socket\n}) {\n  let [display, setDisplay] = useState(\"initial\");\n  let [currentRoom, setCurrentRoom] = useState(false);\n  let [showBackdrop, setShowBackdrop] = useState(false);\n  let [showUsers, setShowUsers] = useState(false);\n  let [showCreateRoomModal, setShowCreateRoomModal] = useState(false); // fully accepted friends\n\n  let [userFriends, setUserFriends] = useState([]); // users who have requested client's friendship\n\n  let [userPendingFriends, setUserPendingFriends] = useState([]); // users who the client has sent friend requests to\n\n  let [userSentFriendRequests, setUserSentFriendRequests] = useState([]);\n  let [userRooms, setUserRooms] = useState(false);\n  let [populatedRooms, setPopulatedRooms] = useState([]);\n  let [newRoomData, setNewRoomData] = useState({});\n  let userAuth = useContext(AuthContext);\n  let user = userAuth;\n  let name, email, photoUrl, uid, emailVerified;\n  name = user.displayName;\n  email = user.email;\n  photoUrl = user.photoURL;\n  emailVerified = user.emailVerified;\n  uid = user.uid; // fetches friends\n\n  useEffect(() => {\n    socket.emit(\"requestTop8Rooms\");\n    socket.emit(\"requestUserRooms\", uid);\n    socket.emit(\"fetch-friends\", {\n      uid\n    });\n  }, []);\n  socket.on(\"userFriends\", userFriends => {\n    console.log(`FRIEND DATA ${JSON.stringify(userFriends)}`);\n    const friends = [];\n    const friendsRequested = [];\n    const pendingFriends = [];\n    userFriends.map(friend => {\n      switch (friend.isFriend) {\n        case \"pending\":\n          pendingFriends.push(friend);\n          return;\n\n        case \"sent\":\n          friendsRequested.push(friend);\n          return;\n\n        case true:\n          friends.push(friend);\n          return;\n      }\n    });\n    setUserFriends(friends);\n    setUserPendingFriends(pendingFriends);\n    setUserSentFriendRequests(friendsRequested);\n  });\n  socket.on(\"userRooms\", userRooms => {\n    console.log(userRooms);\n    setUserRooms(userRooms);\n  });\n  socket.on(\"top8Rooms\", topRooms => setPopulatedRooms(topRooms));\n  let firebaseDoesNotExist, db; // Check if firebase instance exists\n\n  firebaseDoesNotExist = !firebase.apps.length;\n\n  if (firebaseDoesNotExist) {\n    // Initialize Firebase\n    db = firebase.initializeApp(firebaseConfig).firestore();\n  } else {\n    db = firebase.app().firestore();\n  }\n\n  const handleJoinRoom = room => {\n    console.log(`Room sent to backend: ${JSON.stringify(room)}`);\n    socket.emit(\"join\", {\n      user: {\n        displayName: name,\n        id: uid\n      },\n      room\n    });\n    setCurrentRoom(room);\n  };\n\n  const handleDisplayFriendsTab = () => {\n    let newDisplay;\n    newDisplay = display == \"rooms\" ? \"initial\" : \"friends\";\n    setDisplay(newDisplay);\n  };\n\n  const handleCloseFriends = () => {\n    let newDisplay;\n    newDisplay = display == \"initial\" ? \"rooms\" : false;\n    setDisplay(newDisplay);\n  }; // const handleUserPendingFriendChange = (newUserPendingFriendArray) => {\n  //   setUserPendingFriends(newUserPendingFriendArray);\n  // };\n\n\n  const handleDisplayRooms = () => {\n    let newDisplay;\n    newDisplay = display == \"friends\" ? \"initial\" : \"rooms\";\n    setDisplay(newDisplay);\n  };\n\n  const handleCloseRoomsTab = () => {\n    let newDisplay;\n    newDisplay = display == \"initial\" ? \"friends\" : false;\n    setDisplay(newDisplay);\n  };\n\n  const handleRevertDefault = () => {\n    setDisplay(false);\n  };\n\n  const clearChat = room => {\n    setCurrentRoom(false);\n    disconnectUser(room);\n  };\n\n  const disconnectUser = room => {\n    socket.emit(\"room-disconnect\", {\n      room,\n      user: {\n        displayName: name,\n        id: uid\n      }\n    });\n  };\n\n  const closeBackdrop = () => {\n    setShowBackdrop(false);\n    setShowCreateRoomModal(false);\n    setShowUsers(false);\n  };\n\n  const openBackdrop = () => {\n    setShowBackdrop(true);\n  };\n\n  const handleShowCreateRoomModal = () => {\n    setShowCreateRoomModal(true);\n    setShowBackdrop(true);\n  };\n\n  const declineFriendRequest = (id, requestAuthorID) => {\n    socket.emit(\"decline-friend-request\", {\n      id,\n      requestAuthorID\n    });\n  };\n\n  const acceptFriendRequest = (id, requestAuthorID) => {\n    socket.emit(\"accept-friend-request\", {\n      id,\n      requestAuthorID\n    });\n  };\n\n  socket.on(\"newRoomID\", roomID => {\n    const data = {\n      user: { ...newRoomData.user\n      },\n      room: { ...newRoomData.room\n      }\n    };\n    data.room.id = roomID;\n    console.log(data);\n    if (data.room.id && data.room.name && data.user.id && data.user.name) socket.emit(\"join\", data);\n  });\n\n  const handleRoomCreation = data => {\n    console.log(data);\n    socket.emit(\"createNewRoom\", data);\n    setNewRoomData({\n      room: {\n        roomName: data.roomName,\n        password: data.password\n      },\n      user: {\n        id: data.creatorUID,\n        name: data.creator\n      }\n    });\n    const roomObj = data;\n    const roomString = data.roomName;\n    setCurrentRoom(data.roomName);\n    closeBackdrop();\n  };\n\n  const handleAddFriend = (uid, friendUID, displayName) => {\n    const newPendingFriend = {\n      displayName,\n      id: friendUID,\n      isFriend: \"sent\"\n    };\n    const newArray = [...userPendingFriends, newPendingFriend];\n    setUserSentFriendRequests(newArray);\n    socket.emit(\"add-friend\", {\n      uid,\n      friendUID\n    });\n  };\n\n  const handleRemoveFriend = (uid, friendUID, callback = false) => {\n    // whether or not friendUID has been found in any of the friend states\n    let notFound = true; // socket event that will fire if friendUID corresponds to a user.\n\n    const emit = () => socket.emit(\"remove-friend\", {\n      uid,\n      friendUID\n    }); // check pendingfriends for requested user\n\n\n    const newPendingFriendArray = userPendingFriends.filter(friend => {\n      if (friend.id == friendUID) {\n        notFound = false;\n        return false;\n      } else return true;\n    });\n\n    if (notFound) {\n      // keep searching sent friends\n      const newRequestedFriendArray = userSentFriendRequests.filter(friend => {\n        if (friend.id == friendUID) {\n          notFound = false;\n          return false;\n        } else return true;\n      });\n\n      if (notFound) {\n        // search accepted friends\n        const newUserFriendArray = userFriends.filter(friend => {\n          if (friend.id == friendUID) {\n            notFound = false;\n            return false;\n          } else return true;\n        });\n\n        if (notFound) {// error! uid doesn't correspond to any user in friends list\n        } else {\n          setUserFriends(newUserFriendArray);\n          emit();\n        }\n      } else {\n        setUserSentFriendRequests(newRequestedFriendArray);\n        emit();\n      }\n    } else {\n      setUserPendingFriends(newPendingFriendArray);\n      emit();\n    }\n\n    console.log(\"removing friend!\");\n\n    if (callback) {\n      callback();\n    }\n  };\n\n  const requestFetchFriends = uid => {\n    socket.emit(\"fetch-friend\", {\n      uid\n    });\n  };\n\n  const handleCancelFriendRequest = (authorID, recipientID) => {\n    socket.emit(\"cancel-friend-request\", {\n      authorID,\n      recipientID\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(HomePageGrid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 356,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(GlobalStyle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 357,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Navigation, {\n    pageOnDisplay: display,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(FaUserFriends, {\n    onClick: handleDisplayFriendsTab,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 359,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(FaHome, {\n    onClick: handleRevertDefault,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 11\n    }\n  }), \" \", /*#__PURE__*/React.createElement(FaRegComments, {\n    onClick: handleDisplayRooms,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(FriendsTab, {\n    pageOnDisplay: display,\n    logoutHandler: firebaseController.logout,\n    closeTabHandler: handleCloseFriends,\n    friends: userFriends,\n    pendingFriends: userPendingFriends,\n    sentFriendRequests: userSentFriendRequests,\n    clientID: uid,\n    handleAccept: acceptFriendRequest,\n    handleDecline: declineFriendRequest,\n    handleDeleteFriend: handleRemoveFriend,\n    handleCancelFriendRequest: handleCancelFriendRequest,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(CreateRoomModal, {\n    visible: showCreateRoomModal,\n    closeHandler: closeBackdrop,\n    submitHandler: handleRoomCreation,\n    user: user,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 9\n    }\n  }), currentRoom ? /*#__PURE__*/React.createElement(Chat, {\n    user: user,\n    room: currentRoom,\n    openBackdrop: openBackdrop,\n    closeChatHandler: clearChat,\n    socket: socket,\n    showUsers: showUsers,\n    setShowUsers: setShowUsers,\n    handleAddFriend: handleAddFriend,\n    handleRemoveFriend: handleRemoveFriend,\n    userRooms: userRooms,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 384,\n      columnNumber: 11\n    }\n  }) : /*#__PURE__*/React.createElement(Join, {\n    user: user,\n    joinHandler: handleJoinRoom,\n    previewedRooms: populatedRooms,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(RoomsTab, {\n    joinHandler: handleJoinRoom,\n    pageOnDisplay: display,\n    closeTabHandler: handleCloseRoomsTab,\n    createRoomHandler: handleShowCreateRoomModal,\n    closeCreateRoomHandler: closeBackdrop,\n    rooms: userRooms,\n    user: {\n      id: uid,\n      displayName: name\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Backdrop, {\n    closeBackdrop: closeBackdrop,\n    visible: showBackdrop,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 413,\n      columnNumber: 7\n    }\n  }));\n}","map":{"version":3,"sources":["C:/Users/Willp/Desktop/chat-app-sage/chat-app-client-master/src/pages/HomePage/HomePage.js"],"names":["React","useState","useEffect","useLayoutEffect","useContext","FaUserFriends","FaRegComments","FaHome","styled","firebase","firebaseConfig","firebaseController","FriendsTab","RoomsTab","Chat","Join","Backdrop","CreateRoomModal","AuthContext","BackdropContextProvier","Theme","GlobalStyle","HomePageGrid","main","Navigation","nav","layout","gridRowNav","gridColNav","navTransitionDuration","props","pageOnDisplay","navColorActive","navColorInactive","HomePage","socket","display","setDisplay","currentRoom","setCurrentRoom","showBackdrop","setShowBackdrop","showUsers","setShowUsers","showCreateRoomModal","setShowCreateRoomModal","userFriends","setUserFriends","userPendingFriends","setUserPendingFriends","userSentFriendRequests","setUserSentFriendRequests","userRooms","setUserRooms","populatedRooms","setPopulatedRooms","newRoomData","setNewRoomData","userAuth","user","name","email","photoUrl","uid","emailVerified","displayName","photoURL","emit","on","console","log","JSON","stringify","friends","friendsRequested","pendingFriends","map","friend","isFriend","push","topRooms","firebaseDoesNotExist","db","apps","length","initializeApp","firestore","app","handleJoinRoom","room","id","handleDisplayFriendsTab","newDisplay","handleCloseFriends","handleDisplayRooms","handleCloseRoomsTab","handleRevertDefault","clearChat","disconnectUser","closeBackdrop","openBackdrop","handleShowCreateRoomModal","declineFriendRequest","requestAuthorID","acceptFriendRequest","roomID","data","handleRoomCreation","roomName","password","creatorUID","creator","roomObj","roomString","handleAddFriend","friendUID","newPendingFriend","newArray","handleRemoveFriend","callback","notFound","newPendingFriendArray","filter","newRequestedFriendArray","newUserFriendArray","requestFetchFriends","handleCancelFriendRequest","authorID","recipientID","logout"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useLayoutEffect, useContext } from \"react\";\r\nimport { FaUserFriends, FaRegComments, FaHome } from \"react-icons/fa\";\r\nimport styled from \"styled-components\";\r\n\r\nimport * as firebase from \"firebase/app\";\r\n// Add the Firebase services that you want to use\r\nimport \"firebase/auth\";\r\nimport \"firebase/firestore\";\r\nimport firebaseConfig from \"../../firebaseConfig\";\r\nimport { firebaseController } from \"../../App\";\r\n\r\nimport FriendsTab from \"./FriendsTab/FriendsTab\";\r\nimport RoomsTab from \"./RoomsTab/RoomsTab\";\r\nimport Chat from \"../../components/Chat/Chat\";\r\nimport Join from \"../../components/Join/Join\";\r\nimport Backdrop from \"../../components/UI/Backdrop/Backdrop\";\r\nimport CreateRoomModal from \"./NewRoomModal/NewRoomModal\";\r\n\r\nimport { AuthContext } from \"../../App\";\r\nimport { BackdropContextProvier } from \"../../components/UI/Backdrop/Backdrop\";\r\n\r\nimport Theme from \"../../util/Theme/Theme\";\r\nimport GlobalStyle from \"../../util/GlobalStyles/GlobalStyles\";\r\n\r\n//      **********TODOS***********\r\n//\r\n// Create roomDisconnect event to fire when user clicks X on chat window, thus leaving the chat.\r\n\r\n//          *****STYLING*****\r\n// Fix following issue: When page is loaded directly from url bar and not from login page, it redirects to login even if immediately authenticated.\r\n// adjust proportions of menus - they take up too much space.\r\n// Create chat bubbles, user text backgrounds for better message differentiation\r\n// Chat app looks a little stretched out on desktop, adjust for better\r\n// center focus\r\n\r\n/* Description of implementation of this component:\r\n\r\n3 states\r\n1.) display no side bars, only main conversation\r\n2.) show left sidebar\r\n3.) show right sidebar\r\n\r\nWe should seek to adjust the whitespace around the main component so it never shifts the content. I'm thinking a system like this will work:\r\n<main>\r\n  <leftsidebar />\r\n    <content-wrapper>\r\n      <chat />\r\n    </content-wrapper>\r\n  <rightsidebar />\r\n</main>\r\n\r\nthe main will be a grid. the main will have state that controls the display, and the grid css will correspond to the state to render the screen how we want.\r\ni.e. in state 1 content-wrapper will span the whole grid, in state 2 it'll span the right 3/4 of the screen, in state 3 it'll span the left 3/4 of the screen.\r\n*/\r\n\r\nconst HomePageGrid = styled.main`\r\n  display: grid;\r\n  grid-template-columns: 1fr 3fr 1fr;\r\n  grid-template-rows: repeat(10, 1fr);\r\n  height: 100vh;\r\n  max-width: 100vw;\r\n  overflow: hidden;\r\n  background: #016789;\r\n`;\r\n\r\nconst Navigation = styled.nav`\r\n  font-size: 2rem;\r\n  display: flex;\r\n  height: 10vh;\r\n  justify-content: space-between;\r\n  grid-row: ${Theme.layout.gridRowNav};\r\n  width: 100%;\r\n  grid-column: ${Theme.layout.gridColNav};\r\n  z-index: 1;\r\n  padding-top: 1rem;\r\n  color: rgba(255, 255, 255, 0.9);\r\n  & svg {\r\n    transition: all ${Theme.navTransitionDuration};\r\n  }\r\n  & svg:first-child {\r\n    margin-left: 1rem;\r\n    color: ${(props) =>\r\n      props.pageOnDisplay == \"friends\"\r\n        ? `${Theme.navColorActive}`\r\n        : `${Theme.navColorInactive}`};\r\n  }\r\n  & svg:last-child {\r\n    margin-right: 1rem;\r\n    color: ${(props) =>\r\n      props.pageOnDisplay == \"rooms\"\r\n        ? `${Theme.navColorActive}`\r\n        : `${Theme.navColorInactive}`};\r\n  }\r\n      @media screen and (min-width: 1200px) {\r\n        font-size: 2.25rem;\r\n        & svg:first-child {\r\n          margin-left: 3rem;\r\n        }\r\n        & svg:last-child {\r\n          margin-right: 3rem;\r\n        }\r\n        }\r\n        @media screen and (min-width: 1600px) {\r\n          font-size: 2.5rem;\r\n          & svg:first-child {\r\n            margin-left: 4.5rem;\r\n          }\r\n          & svg:last-child {\r\n            margin-right: 4.5rem;\r\n          }\r\n          }\r\n          }\r\n`;\r\n\r\nexport default function HomePage({ socket }) {\r\n  let [display, setDisplay] = useState(\"initial\");\r\n  let [currentRoom, setCurrentRoom] = useState(false);\r\n  let [showBackdrop, setShowBackdrop] = useState(false);\r\n  let [showUsers, setShowUsers] = useState(false);\r\n  let [showCreateRoomModal, setShowCreateRoomModal] = useState(false);\r\n  // fully accepted friends\r\n  let [userFriends, setUserFriends] = useState([]);\r\n  // users who have requested client's friendship\r\n  let [userPendingFriends, setUserPendingFriends] = useState([]);\r\n  // users who the client has sent friend requests to\r\n  let [userSentFriendRequests, setUserSentFriendRequests] = useState([]);\r\n  let [userRooms, setUserRooms] = useState(false);\r\n  let [populatedRooms, setPopulatedRooms] = useState([]);\r\n  let [newRoomData, setNewRoomData] = useState({});\r\n  let userAuth = useContext(AuthContext);\r\n  let user = userAuth;\r\n  let name, email, photoUrl, uid, emailVerified;\r\n  name = user.displayName;\r\n  email = user.email;\r\n  photoUrl = user.photoURL;\r\n  emailVerified = user.emailVerified;\r\n  uid = user.uid;\r\n  // fetches friends\r\n\r\n  useEffect(() => {\r\n    socket.emit(\"requestTop8Rooms\");\r\n    socket.emit(\"requestUserRooms\", uid);\r\n    socket.emit(\"fetch-friends\", { uid });\r\n  }, []);\r\n\r\n  socket.on(\"userFriends\", (userFriends) => {\r\n    console.log(`FRIEND DATA ${JSON.stringify(userFriends)}`);\r\n    const friends = [];\r\n    const friendsRequested = [];\r\n    const pendingFriends = [];\r\n    userFriends.map((friend) => {\r\n      switch (friend.isFriend) {\r\n        case \"pending\":\r\n          pendingFriends.push(friend);\r\n          return;\r\n        case \"sent\":\r\n          friendsRequested.push(friend);\r\n          return;\r\n        case true:\r\n          friends.push(friend);\r\n          return;\r\n      }\r\n    });\r\n    setUserFriends(friends);\r\n    setUserPendingFriends(pendingFriends);\r\n    setUserSentFriendRequests(friendsRequested);\r\n  });\r\n\r\n  socket.on(\"userRooms\", (userRooms) => {\r\n    console.log(userRooms);\r\n    setUserRooms(userRooms);\r\n  });\r\n\r\n  socket.on(\"top8Rooms\", (topRooms) => setPopulatedRooms(topRooms));\r\n  let firebaseDoesNotExist, db;\r\n  // Check if firebase instance exists\r\n  firebaseDoesNotExist = !firebase.apps.length;\r\n  if (firebaseDoesNotExist) {\r\n    // Initialize Firebase\r\n    db = firebase.initializeApp(firebaseConfig).firestore();\r\n  } else {\r\n    db = firebase.app().firestore();\r\n  }\r\n\r\n  const handleJoinRoom = (room) => {\r\n    console.log(`Room sent to backend: ${JSON.stringify(room)}`);\r\n    socket.emit(\"join\", { user: { displayName: name, id: uid }, room });\r\n    setCurrentRoom(room);\r\n  };\r\n\r\n  const handleDisplayFriendsTab = () => {\r\n    let newDisplay;\r\n    newDisplay = display == \"rooms\" ? \"initial\" : \"friends\";\r\n    setDisplay(newDisplay);\r\n  };\r\n\r\n  const handleCloseFriends = () => {\r\n    let newDisplay;\r\n    newDisplay = display == \"initial\" ? \"rooms\" : false;\r\n    setDisplay(newDisplay);\r\n  };\r\n\r\n  // const handleUserPendingFriendChange = (newUserPendingFriendArray) => {\r\n  //   setUserPendingFriends(newUserPendingFriendArray);\r\n  // };\r\n\r\n  const handleDisplayRooms = () => {\r\n    let newDisplay;\r\n    newDisplay = display == \"friends\" ? \"initial\" : \"rooms\";\r\n    setDisplay(newDisplay);\r\n  };\r\n\r\n  const handleCloseRoomsTab = () => {\r\n    let newDisplay;\r\n    newDisplay = display == \"initial\" ? \"friends\" : false;\r\n    setDisplay(newDisplay);\r\n  };\r\n\r\n  const handleRevertDefault = () => {\r\n    setDisplay(false);\r\n  };\r\n\r\n  const clearChat = (room) => {\r\n    setCurrentRoom(false);\r\n    disconnectUser(room);\r\n  };\r\n\r\n  const disconnectUser = (room) => {\r\n    socket.emit(\"room-disconnect\", {\r\n      room,\r\n      user: { displayName: name, id: uid },\r\n    });\r\n  };\r\n\r\n  const closeBackdrop = () => {\r\n    setShowBackdrop(false);\r\n    setShowCreateRoomModal(false);\r\n    setShowUsers(false);\r\n  };\r\n  const openBackdrop = () => {\r\n    setShowBackdrop(true);\r\n  };\r\n\r\n  const handleShowCreateRoomModal = () => {\r\n    setShowCreateRoomModal(true);\r\n    setShowBackdrop(true);\r\n  };\r\n\r\n  const declineFriendRequest = (id, requestAuthorID) => {\r\n    socket.emit(\"decline-friend-request\", { id, requestAuthorID });\r\n  };\r\n\r\n  const acceptFriendRequest = (id, requestAuthorID) => {\r\n    socket.emit(\"accept-friend-request\", { id, requestAuthorID });\r\n  };\r\n\r\n  socket.on(\"newRoomID\", (roomID) => {\r\n    const data = {\r\n      user: { ...newRoomData.user },\r\n      room: { ...newRoomData.room },\r\n    };\r\n    data.room.id = roomID;\r\n    console.log(data);\r\n    if (data.room.id && data.room.name && data.user.id && data.user.name)\r\n      socket.emit(\"join\", data);\r\n  });\r\n\r\n  const handleRoomCreation = (data) => {\r\n    console.log(data);\r\n    socket.emit(\"createNewRoom\", data);\r\n    setNewRoomData({\r\n      room: { roomName: data.roomName, password: data.password },\r\n      user: { id: data.creatorUID, name: data.creator },\r\n    });\r\n\r\n    const roomObj = data;\r\n    const roomString = data.roomName;\r\n    setCurrentRoom(data.roomName);\r\n    closeBackdrop();\r\n  };\r\n\r\n  const handleAddFriend = (uid, friendUID, displayName) => {\r\n    const newPendingFriend = { displayName, id: friendUID, isFriend: \"sent\" };\r\n    const newArray = [...userPendingFriends, newPendingFriend];\r\n    setUserSentFriendRequests(newArray);\r\n    socket.emit(\"add-friend\", { uid, friendUID });\r\n  };\r\n\r\n  const handleRemoveFriend = (uid, friendUID, callback = false) => {\r\n    // whether or not friendUID has been found in any of the friend states\r\n    let notFound = true;\r\n\r\n    // socket event that will fire if friendUID corresponds to a user.\r\n    const emit = () => socket.emit(\"remove-friend\", { uid, friendUID });\r\n    // check pendingfriends for requested user\r\n    const newPendingFriendArray = userPendingFriends.filter((friend) => {\r\n      if (friend.id == friendUID) {\r\n        notFound = false;\r\n        return false;\r\n      } else return true;\r\n    });\r\n\r\n    if (notFound) {\r\n      // keep searching sent friends\r\n      const newRequestedFriendArray = userSentFriendRequests.filter(\r\n        (friend) => {\r\n          if (friend.id == friendUID) {\r\n            notFound = false;\r\n            return false;\r\n          } else return true;\r\n        }\r\n      );\r\n\r\n      if (notFound) {\r\n        // search accepted friends\r\n        const newUserFriendArray = userFriends.filter((friend) => {\r\n          if (friend.id == friendUID) {\r\n            notFound = false;\r\n            return false;\r\n          } else return true;\r\n        });\r\n\r\n        if (notFound) {\r\n          // error! uid doesn't correspond to any user in friends list\r\n        } else {\r\n          setUserFriends(newUserFriendArray);\r\n          emit();\r\n        }\r\n      } else {\r\n        setUserSentFriendRequests(newRequestedFriendArray);\r\n        emit();\r\n      }\r\n    } else {\r\n      setUserPendingFriends(newPendingFriendArray);\r\n      emit();\r\n    }\r\n    console.log(\"removing friend!\");\r\n    if (callback) {\r\n      callback();\r\n    }\r\n  };\r\n\r\n  const requestFetchFriends = (uid) => {\r\n    socket.emit(\"fetch-friend\", { uid });\r\n  };\r\n\r\n  const handleCancelFriendRequest = (authorID, recipientID) => {\r\n    socket.emit(\"cancel-friend-request\", {\r\n      authorID,\r\n      recipientID,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <HomePageGrid>\r\n        <GlobalStyle />\r\n        <Navigation pageOnDisplay={display}>\r\n          <FaUserFriends onClick={handleDisplayFriendsTab} />\r\n          <FaHome onClick={handleRevertDefault} /> {/* Link to homepage */}\r\n          <FaRegComments onClick={handleDisplayRooms} />\r\n        </Navigation>\r\n        <FriendsTab\r\n          pageOnDisplay={display}\r\n          logoutHandler={firebaseController.logout}\r\n          closeTabHandler={handleCloseFriends}\r\n          friends={userFriends}\r\n          pendingFriends={userPendingFriends}\r\n          sentFriendRequests={userSentFriendRequests}\r\n          clientID={uid}\r\n          handleAccept={acceptFriendRequest}\r\n          handleDecline={declineFriendRequest}\r\n          handleDeleteFriend={handleRemoveFriend}\r\n          handleCancelFriendRequest={handleCancelFriendRequest}\r\n        ></FriendsTab>\r\n        <CreateRoomModal\r\n          visible={showCreateRoomModal}\r\n          closeHandler={closeBackdrop}\r\n          submitHandler={handleRoomCreation}\r\n          user={user}\r\n        />\r\n\r\n        {currentRoom ? (\r\n          <Chat\r\n            user={user}\r\n            room={currentRoom}\r\n            openBackdrop={openBackdrop}\r\n            closeChatHandler={clearChat}\r\n            socket={socket}\r\n            showUsers={showUsers}\r\n            setShowUsers={setShowUsers}\r\n            handleAddFriend={handleAddFriend}\r\n            handleRemoveFriend={handleRemoveFriend}\r\n            userRooms={userRooms}\r\n          />\r\n        ) : (\r\n          <Join\r\n            user={user}\r\n            joinHandler={handleJoinRoom}\r\n            previewedRooms={populatedRooms}\r\n          />\r\n        )}\r\n        <RoomsTab\r\n          joinHandler={handleJoinRoom}\r\n          pageOnDisplay={display}\r\n          closeTabHandler={handleCloseRoomsTab}\r\n          createRoomHandler={handleShowCreateRoomModal}\r\n          closeCreateRoomHandler={closeBackdrop}\r\n          rooms={userRooms}\r\n          user={{ id: uid, displayName: name }}\r\n        ></RoomsTab>\r\n      </HomePageGrid>\r\n      <Backdrop closeBackdrop={closeBackdrop} visible={showBackdrop} />\r\n    </>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}